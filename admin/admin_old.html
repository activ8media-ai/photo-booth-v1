<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel</title>
  <link rel="stylesheet" href="../public/styles.css">
</head>
<body>
  <div class="center-container">
    <h1>Admin Panel</h1>
    <section>
      <h2>Processed Images</h2>
      <ul id="images-list">
        <!-- Processed images will be loaded here -->
      </ul>
    </section>
    <section>
      <h2>Events</h2>
      <ul id="events-list">
        <!-- Events will be loaded here -->
      </ul>
    </section>
  </div>

  <script>
    // Function to fetch and display processed images
    async function loadImages() {
      const response = await fetch('/admin/images');
      const images = await response.json();
      const imagesList = document.getElementById('images-list');
      imagesList.innerHTML = ''; // Clear existing list

      images.forEach(image => {
        const listItem = document.createElement('li');
        listItem.style.display = 'flex';
        listItem.style.alignItems = 'center';
        listItem.innerHTML = `
          <img src="${image.imagePath}" alt="Processed Image" style="max-width:100px; margin-right:10px;">
          <a href="${image.downloadLink}" target="_blank" style="margin-right:10px;">Download</a>
          <button onclick="deleteImage('${image.id}')">Delete</button>
        `;
        imagesList.appendChild(listItem);
      });
    }

    // Function to delete an image
    async function deleteImage(photoId) {
      if (confirm('Are you sure you want to delete this image?')) {
        const response = await fetch(`/admin/images/${photoId}`, { method: 'DELETE' });
        if (response.ok) {
          alert('Image deleted successfully');
          loadImages(); // Reload the images list
        } else {
          alert('Failed to delete image');
        }
      }
    }

    // Fetch and display events
    async function loadEvents() {
      const response = await fetch('/admin/events');
      const events = await response.json();
      const eventsList = document.getElementById('events-list');

      events.forEach(event => {
        const listItem = document.createElement('li');
        listItem.innerText = `Event: ${event.name}, Booths: ${event.booths}`;
        eventsList.appendChild(listItem);
      });
    }

    // Load images and events when the page loads
    window.onload = () => {
      loadImages();
      loadEvents();
    };
  </script>
</body>
</html>
